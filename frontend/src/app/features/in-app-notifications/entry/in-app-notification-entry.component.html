<div
    class="op-ian-item"
    attr.data-qa-selector="op-ian-notification-item-{{notification.id}}"
>
  <button
      type="button"
      class="op-ian-item--row"
      (click)="toggleDetails()"
  >
    <span
        class="op-ian-item--indicator"
        [class.op-ian-item--indicator_read]="!!notification.read"
    ></span>
    <div class="op-ian-item--message">
      <a
          *ngIf="notification._links.project"
          class="op-ian-item--project"
          [href]="notification._links.project.href"
          [textContent]="notification._links.project.title"
          target="_blank"
      ></a>
      <ng-container *ngIf="workPackage$ && (workPackage$ | async) as workPackage; else workPackageLoading">
        <span
            class="op-ian-item--title"
            ngPreserveWhitespaces
        >
          <span [ngClass]="'__hl_inline_type_' + workPackage.type.id" [textContent]="workPackage.type.name">
          </span>
            <a
                [attr.title]="workPackage.subject"
                uiSref="work-packages.show"
                [uiParams]="{workPackageId: workPackage.id}"
                [textContent]="'#' + workPackage.id"
            >
          </a>
          <span [textContent]="workPackage.subject">
          </span>
        </span>
      </ng-container>
      <ng-template #workPackageLoading>
        <span
            class="op-ian-item--title"
            [textContent]="text.loading"
        ></span>
      </ng-template>
      <ng-container *ngIf="!workPackage$">
        <span
            class="op-ian-item--title"
            [textContent]="notification.subject"
        ></span>
      </ng-container>
    </div>
    <div
        class="op-ian-item--reason"
        [textContent]="notification.reason"
    ></div>
    <div
        class="op-ian-item--date"
        [textContent]="notification.date"
    ></div>
  </button>
  <div
      *ngIf="expanded"
      class="op-ian-item--details"
  >
    <ul class="work-package-details-activities-messages" *ngIf="notification.details">
      <ng-container *ngFor="let detail of notification.details">
        <li *ngIf="detail.html && detail.html !== ''">
          <span
              class="message"
              [innerHtml]="detail.html"
          ></span>
        </li>
      </ng-container>
    </ul>
  </div>
</div>